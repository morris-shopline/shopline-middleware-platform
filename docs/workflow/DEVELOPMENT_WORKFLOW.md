# 開發流程規範

## 🎯 目的

建立標準化的開發流程，確保：
- 需求明確定義
- 規格完整記錄
- 測試充分執行
- 文件同步更新
- 所有 Agent 遵循相同流程

## 📊 開發流程（Development Workflow）

```
1. 需求分析 (Requirement Analysis)
   ↓
2. 架構設計 (Architecture Design)
   ↓
3. Epic & Story 規劃 (Epic & Story Planning)
   ↓
4. 規格確認 (Specification Confirmation)
   ↓
5. 測試案例設計 (Test Case Design)
   ↓
6. 開發實作 (Development Implementation)
   ↓
7. 功能測試 (Feature Testing)
   ↓
8. 用戶驗收 (User Acceptance Testing)
   ↓
9. 文件更新 (Documentation Update)
   ↓
10. Sprint 完成 (Sprint Completion)
```

## 📝 各階段詳細說明

### 1. 需求分析 (Requirement Analysis)

#### 目標
- 理解用戶需求和使用情境
- 確認功能範圍和優先級
- 識別技術限制和風險

#### 產出
- 需求說明文件
- 使用情境描述
- 功能優先級列表

#### 檢查點
- [ ] 用戶需求已充分理解
- [ ] 使用情境已明確描述
- [ ] 技術可行性已評估
- [ ] 風險已識別

### 2. 架構設計 (Architecture Design)

#### 目標
- 設計系統架構
- 規劃 API 端點和資料流
- 確定技術選型

#### 產出
- 架構設計圖
- API 端點設計
- 資料庫 Schema 設計
- 技術選型說明

#### 檢查點
- [ ] 架構圖已完成
- [ ] API 設計已確認
- [ ] 資料庫設計已規劃
- [ ] 技術選型已確定

### 3. Epic & Story 規劃 (Epic & Story Planning)

#### 目標
- 將需求拆分為 Epic 和 Story
- 規劃 Sprint 範圍
- 估算工作量

#### 產出
- Epic 列表
- User Story 列表
- Sprint Backlog
- 工作量估算

#### 檢查點
- [ ] Epic 已定義
- [ ] Story 已拆分
- [ ] Sprint 範圍已確定
- [ ] 工作量已估算

### 4. 規格確認 (Specification Confirmation)

#### 目標
- 撰寫詳細規格文件
- 與用戶確認規格
- 確保理解一致

#### 產出
- 功能規格文件（Spec）
- API 規格文件
- UI/UX 設計稿（如需要）

#### 檢查點
- [ ] 規格已撰寫完成
- [ ] 規格已與用戶確認
- [ ] API 規格已定義
- [ ] UI/UX 設計已確認（如需要）

### 5. 測試案例設計 (Test Case Design)

#### 目標
- 設計完整的測試案例
- 定義測試標準
- 規劃測試流程

#### 產出
- 測試案例文件
- 測試資料準備
- 測試標準定義

#### 檢查點
- [ ] 測試案例已設計
- [ ] 測試資料已準備
- [ ] 測試標準已定義
- [ ] 測試流程已規劃

### 6. 開發實作 (Development Implementation)

#### 目標
- 依據規格進行開發
- 遵循程式碼品質標準
- 進行單元測試
- **確保本地和 Vercel 環境同時實作**

#### 產出
- 實作代碼
- 單元測試
- 代碼註解

#### ⚠️ **新增 API 端點時的強制流程**
**必須完成**：`docs/workflow/API_DEVELOPMENT_CHECKLIST.md`
1. 實作本地路由 (`server.js`)
2. 建立 Vercel Serverless Function (`api/**/*.js`)
3. 更新前端環境偵測 (`public/js/app.js`)
4. 本地測試通過
5. Vercel 測試通過

#### 檢查點
- [ ] 代碼已完成（**本地 + Vercel 雙環境**）
- [ ] 單元測試已通過
- [ ] 代碼品質已檢查
- [ ] 註解已完整
- [ ] **API 開發檢查清單已完成（如適用）**

### 7. 功能測試 (Feature Testing)

#### 目標
- 執行完整的功能測試
- 驗證所有測試案例
- 記錄測試結果

#### 產出
- 測試報告
- Bug 列表（如有）
- 測試截圖/影片

#### 檢查點
- [ ] 所有測試案例已執行
- [ ] 測試結果已記錄
- [ ] Bug 已修復
- [ ] 回歸測試已通過

### 8. 用戶驗收 (User Acceptance Testing)

#### 目標
- 引導用戶進行測試
- 收集用戶反饋
- 確認功能符合預期

#### 產出
- 用戶測試指南
- 用戶反饋記錄
- 驗收報告

#### 檢查點
- [ ] 測試指南已提供
- [ ] 用戶測試已完成
- [ ] 反饋已收集
- [ ] 功能已被接受

### 9. 文件更新 (Documentation Update)

#### 目標
- 更新所有相關文件
- 記錄實作差異
- 同步最新狀態

#### 產出
- 更新後的文件
- 變更日誌
- 版本說明

#### 檢查點
- [ ] API 文件已更新
- [ ] 架構文件已同步
- [ ] 用戶手冊已更新
- [ ] 變更日誌已記錄

### 10. Sprint 完成 (Sprint Completion)

#### 目標
- 總結 Sprint 成果
- 規劃下一個 Sprint
- 進行回顧改進

#### 產出
- Sprint 總結報告
- 下一個 Sprint 規劃
- 改進建議

#### 檢查點
- [ ] 成果已總結
- [ ] 下一個 Sprint 已規劃
- [ ] 經驗已記錄
- [ ] 改進建議已提出

## 🚫 禁止事項

### ❌ 不允許的行為
1. **跳過規格階段直接開發** - 必須先確認規格
2. **未經測試就交付** - 必須完成功能測試
3. **文件與實作不一致** - 必須保持同步
4. **即興修改架構** - 必須先討論並更新設計
5. **未經確認的假設** - 必須與用戶確認
6. **跳過用戶驗收** - 必須取得用戶認可
7. **缺少測試案例** - 必須有完整測試計畫

### ❌ 禁止的藉口
- "這個很簡單，不需要寫規格"
- "我知道怎麼做，先開發再說"
- "測試可以之後補"
- "文件之後再更新"
- "這個應該符合需求"
- "時間不夠，跳過這步"

## ✅ 最佳實踐

### 規格撰寫
- 使用具體的數字和範例
- 提供 API request/response 範例
- 包含錯誤處理情境
- 說明邊界條件

### 測試設計
- 涵蓋正常流程
- 涵蓋錯誤情境
- 涵蓋邊界條件
- 涵蓋效能考量

### 文件維護
- 實作完成後立即更新
- 記錄與規格的差異
- 更新版本號
- 添加變更日誌

### 溝通協作
- 不確定就問
- 定期同步進度
- 記錄決策理由
- 分享經驗教訓

## 📊 品質門檻（Quality Gates）

### 進入開發階段前
- [ ] 規格已完整撰寫
- [ ] 規格已與用戶確認
- [ ] 測試案例已設計
- [ ] 架構設計已完成

### 進入測試階段前
- [ ] 代碼已完成
- [ ] 單元測試已通過
- [ ] 代碼已 Review
- [ ] Linter 檢查已通過

### 進入交付階段前
- [ ] 功能測試已完成
- [ ] 用戶驗收已通過
- [ ] 文件已更新
- [ ] 變更日誌已記錄

## 🔄 持續改進

### Sprint 回顧
- 每個 Sprint 結束進行回顧
- 記錄哪些做得好
- 記錄哪些需要改進
- 制定改進計畫

### 流程優化
- 定期檢視流程效率
- 收集團隊反饋
- 調整不合理的環節
- 更新流程文件

## 📝 範本文件

### Spec 範本
詳見：`docs/templates/SPEC_TEMPLATE.md`

### Test Case 範本
詳見：`docs/templates/TEST_CASE_TEMPLATE.md`

### Sprint 規劃範本
詳見：`docs/templates/SPRINT_PLANNING_TEMPLATE.md`

## 🏗️ **架構與部署文件（必讀）**

### Vercel 架構說明
**強制閱讀**：`docs/architecture/VERCEL_ARCHITECTURE.md`
- 說明本地開發 vs Vercel 部署的架構差異
- 避免「本地正常，Vercel 失敗」的問題

### API 開發檢查清單
**強制執行**：`docs/workflow/API_DEVELOPMENT_CHECKLIST.md`
- 新增任何 API 端點前必須完成檢查清單
- 確保本地和 Vercel 環境同時正常運作

---

**版本**: 1.0.0  
**生效日期**: 2025-10-21  
**適用對象**: 所有參與開發的 Agent 和開發者  
**強制執行**: 是

**⚠️ 重要提醒：所有 Agent 必須嚴格遵循此流程，不得跳過任何步驟！**

